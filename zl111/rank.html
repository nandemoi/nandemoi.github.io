
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>進階程式設計</title>
        <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            h1 { color: #333; }
            .container { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 20px; }
            .card { border: 1px solid #ddd; border-radius: 8px; padding: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
            .card h3 { margin: 0 0 10px 0; color: #333; }
            .card p { margin: 5px 0; }
            .label { font-weight: bold; color: #666; }
            img { max-width: 100%; height: auto; margin-top: 20px; }
        </style>
    </head>
    <body>
        <h1>同學參考一下，把握時間多練習～～～</h1>
        <p>本週你在課堂的努力： <button id="shuffle-btn">亂序排列</button></p>
        <div class="container">
    
            <div class="card" style="background-color: hsl(209, 30%, 90%);">
                <h3>◯昱◯</h3>
                <p><span class="label">ACΔ:</span> 6</p>
                <p><span class="label">耗時Δ:</span> 40231</p>
                <p><span class="label">分數Δ:</span> 3.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(267, 30%, 90%);">
                <h3>◯◯萱</h3>
                <p><span class="label">ACΔ:</span> 3</p>
                <p><span class="label">耗時Δ:</span> 95608</p>
                <p><span class="label">分數Δ:</span> 3.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(11, 30%, 90%);">
                <h3>◯◯辰</h3>
                <p><span class="label">ACΔ:</span> 4</p>
                <p><span class="label">耗時Δ:</span> 93595</p>
                <p><span class="label">分數Δ:</span> 4.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(348, 30%, 90%);">
                <h3>◯◯廷</h3>
                <p><span class="label">ACΔ:</span> 7</p>
                <p><span class="label">耗時Δ:</span> 46903</p>
                <p><span class="label">分數Δ:</span> 3.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(139, 30%, 90%);">
                <h3>◯◯碩</h3>
                <p><span class="label">ACΔ:</span> 2</p>
                <p><span class="label">耗時Δ:</span> 63762</p>
                <p><span class="label">分數Δ:</span> 2.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(0, 30%, 90%);">
                <h3>◯安◯</h3>
                <p><span class="label">ACΔ:</span> 4</p>
                <p><span class="label">耗時Δ:</span> 93577</p>
                <p><span class="label">分數Δ:</span> 4.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(150, 30%, 90%);">
                <h3>◯◯澤</h3>
                <p><span class="label">ACΔ:</span> 2</p>
                <p><span class="label">耗時Δ:</span> 63764</p>
                <p><span class="label">分數Δ:</span> 2.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(23, 30%, 90%);">
                <h3>◯茗◯</h3>
                <p><span class="label">ACΔ:</span> 6</p>
                <p><span class="label">耗時Δ:</span> 140325</p>
                <p><span class="label">分數Δ:</span> 6.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(255, 30%, 90%);">
                <h3>◯宏◯</h3>
                <p><span class="label">ACΔ:</span> 6</p>
                <p><span class="label">耗時Δ:</span> 40146</p>
                <p><span class="label">分數Δ:</span> 3.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(116, 30%, 90%);">
                <h3>◯◯元</h3>
                <p><span class="label">ACΔ:</span> 3</p>
                <p><span class="label">耗時Δ:</span> 70233</p>
                <p><span class="label">分數Δ:</span> 3.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(290, 30%, 90%);">
                <h3>◯頤◯</h3>
                <p><span class="label">ACΔ:</span> 0</p>
                <p><span class="label">耗時Δ:</span> 0</p>
                <p><span class="label">分數Δ:</span> 0.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(243, 30%, 90%);">
                <h3>◯富◯</h3>
                <p><span class="label">ACΔ:</span> 13</p>
                <p><span class="label">耗時Δ:</span> 32399</p>
                <p><span class="label">分數Δ:</span> 6.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(92, 30%, 90%);">
                <h3>◯◯玲</h3>
                <p><span class="label">ACΔ:</span> 7</p>
                <p><span class="label">耗時Δ:</span> 163735</p>
                <p><span class="label">分數Δ:</span> 7.9</p>
            </div>
        
            <div class="card" style="background-color: hsl(313, 30%, 90%);">
                <h3>◯以◯</h3>
                <p><span class="label">ACΔ:</span> 12</p>
                <p><span class="label">耗時Δ:</span> 80354</p>
                <p><span class="label">分數Δ:</span> 6.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(174, 30%, 90%);">
                <h3>◯◯橙</h3>
                <p><span class="label">ACΔ:</span> 7</p>
                <p><span class="label">耗時Δ:</span> 46911</p>
                <p><span class="label">分數Δ:</span> 3.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(58, 30%, 91%);">
                <h3>◯◯緯</h3>
                <p><span class="label">ACΔ:</span> 11</p>
                <p><span class="label">耗時Δ:</span> 257269</p>
                <p><span class="label">分數Δ:</span> 11.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(278, 30%, 91%);">
                <h3>◯◯宇</h3>
                <p><span class="label">ACΔ:</span> 2</p>
                <p><span class="label">耗時Δ:</span> 63717</p>
                <p><span class="label">分數Δ:</span> 2.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(220, 30%, 91%);">
                <h3>◯◯穎</h3>
                <p><span class="label">ACΔ:</span> 4</p>
                <p><span class="label">耗時Δ:</span> 26859</p>
                <p><span class="label">分數Δ:</span> 2.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(325, 30%, 91%);">
                <h3>◯◯洺</h3>
                <p><span class="label">ACΔ:</span> 3</p>
                <p><span class="label">耗時Δ:</span> 70195</p>
                <p><span class="label">分數Δ:</span> 3.7</p>
            </div>
        
            <div class="card" style="background-color: hsl(336, 30%, 91%);">
                <h3>◯◯飛</h3>
                <p><span class="label">ACΔ:</span> 0</p>
                <p><span class="label">耗時Δ:</span> 0</p>
                <p><span class="label">分數Δ:</span> 0.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(104, 30%, 91%);">
                <h3>◯威◯</h3>
                <p><span class="label">ACΔ:</span> 3</p>
                <p><span class="label">耗時Δ:</span> 95611</p>
                <p><span class="label">分數Δ:</span> 3.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(127, 30%, 91%);">
                <h3>◯嘉◯</h3>
                <p><span class="label">ACΔ:</span> 10</p>
                <p><span class="label">耗時Δ:</span> 233942</p>
                <p><span class="label">分數Δ:</span> 10.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(69, 30%, 91%);">
                <h3>◯◯宸</h3>
                <p><span class="label">ACΔ:</span> 9</p>
                <p><span class="label">耗時Δ:</span> 93709</p>
                <p><span class="label">分數Δ:</span> 5.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(197, 30%, 91%);">
                <h3>◯◯齊</h3>
                <p><span class="label">ACΔ:</span> 9</p>
                <p><span class="label">耗時Δ:</span> 60261</p>
                <p><span class="label">分數Δ:</span> 4.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(34, 30%, 91%);">
                <h3>◯◯鈞</h3>
                <p><span class="label">ACΔ:</span> 11</p>
                <p><span class="label">耗時Δ:</span> 73676</p>
                <p><span class="label">分數Δ:</span> 5.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(232, 30%, 91%);">
                <h3>◯克◯</h3>
                <p><span class="label">ACΔ:</span> 7</p>
                <p><span class="label">耗時Δ:</span> 46928</p>
                <p><span class="label">分數Δ:</span> 3.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(81, 30%, 91%);">
                <h3>◯◯宣</h3>
                <p><span class="label">ACΔ:</span> 14</p>
                <p><span class="label">耗時Δ:</span> 110491</p>
                <p><span class="label">分數Δ:</span> 7.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(185, 30%, 91%);">
                <h3>◯◯鑫</h3>
                <p><span class="label">ACΔ:</span> 5</p>
                <p><span class="label">耗時Δ:</span> 133870</p>
                <p><span class="label">分數Δ:</span> 5.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(162, 30%, 91%);">
                <h3>◯◯杰</h3>
                <p><span class="label">ACΔ:</span> 8</p>
                <p><span class="label">耗時Δ:</span> 78778</p>
                <p><span class="label">分數Δ:</span> 4.5</p>
            </div>
        
            <div class="card" style="background-color: hsl(46, 30%, 91%);">
                <h3>◯◯寧</h3>
                <p><span class="label">ACΔ:</span> 1</p>
                <p><span class="label">耗時Δ:</span> 31851</p>
                <p><span class="label">分數Δ:</span> 1.0</p>
            </div>
        
            <div class="card" style="background-color: hsl(301, 30%, 92%);">
                <h3>◯◯傑</h3>
                <p><span class="label">ACΔ:</span> 16</p>
                <p><span class="label">耗時Δ:</span> 157171</p>
                <p><span class="label">分數Δ:</span> 9.5</p>
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
            <div class="empty-card card" style="background-color: white !important; display: none; align-items: center; justify-content: center; font-size: 48px;">
                ❓
            </div>
        
        </div>
    <p>統計：《入門題》,《循序與選擇結構練習》,《課程前測》</p>
<img src="media/ranksum.png" alt="Ranking Summary Histogram">
    <script>
    const emojis = ["⚽️", "🏐", "📎", "🧭", "🐻‍❄️", "🐼", "🥝", "🏀", "🎲", "🪙", "❤️", "🎵", "🔔", "🍎"];

    function getEmptyPositions(cols, numEmpties, total) {
        const rows = total / cols;
        const positions = [];
        for (let y = 0; y < rows; y++) {
            for (let x = 0; x < cols; x++) {
                positions.push({x, y});
            }
        }
        const emptyPositions = [];
        let available = [...positions];
        // Place first empty randomly
        if (numEmpties > 0) {
            const randomIndex = Math.floor(Math.random() * available.length);
            emptyPositions.push(available[randomIndex]);
            available.splice(randomIndex, 1);
        }
        // Place rest with random threshold between 1/2 and 2/3 of farthest distance, reduce edge chance
        for (let i = 1; i < numEmpties; i++) {
            let candidates = [];
            let maxMinDist = -1;
            for (let pos of available) {
                let minDist = Infinity;
                for (let epos of emptyPositions) {
                    const dist = Math.sqrt((pos.x - epos.x) ** 2 + (pos.y - epos.y) ** 2);
                    minDist = Math.min(minDist, dist);
                }
                if (minDist > maxMinDist) {
                    maxMinDist = minDist;
                }
            }
            const threshold = maxMinDist * (0.75 + Math.random() * 0.25);
            for (let pos of available) {
                let minDist = Infinity;
                for (let epos of emptyPositions) {
                    const dist = Math.sqrt((pos.x - epos.x) ** 2 + (pos.y - epos.y) ** 2);
                    minDist = Math.min(minDist, dist);
                }
                if (minDist >= threshold) {
                    candidates.push(pos);
                }
            }
            // Reduce chance of selecting edge positions
            let filteredCandidates = candidates.filter(pos => {
                const isEdge = pos.x === 0 || pos.x === cols - 1 || pos.y === 0 || pos.y === rows - 1;
                if (isEdge) {
                    return Math.random() > 0.7; // 30% chance to keep edge
                } else {
                    return true;
                }
            });
            if (filteredCandidates.length === 0) {
                filteredCandidates = candidates; // fallback if all filtered out
            }
            const randomIndex = Math.floor(Math.random() * filteredCandidates.length);
            const selectedPos = filteredCandidates[randomIndex];
            emptyPositions.push(selectedPos);
            available.splice(available.indexOf(selectedPos), 1);
        }
        return {emptyPositions, available};
    }

    function updateEmpties() {
        const container = document.querySelector('.container');
        const allCards = Array.from(container.children);
        const studentCards = allCards.filter(c => !c.classList.contains('empty-card'));
        const numStudents = studentCards.length;
        const cols = Math.max(1, Math.floor((container.offsetWidth + 10) / 160));
        const remainder = numStudents % cols;
        const numEmptiesNeeded = remainder === 0 ? 0 : cols - remainder;
        const emptyCards = allCards.filter(c => c.classList.contains('empty-card'));
        const total = numStudents + numEmptiesNeeded;
        const {emptyPositions, available} = getEmptyPositions(cols, numEmptiesNeeded, total);
        // Shuffle available positions for students
        for (let i = available.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [available[i], available[j]] = [available[j], available[i]];
        }
        // Create positions array in order
        const positions = [];
        for (let y = 0; y < total / cols; y++) {
            for (let x = 0; x < cols; x++) {
                positions.push({x, y});
            }
        }
        // Assign cards to positions
        let studentIndex = 0;
        let emptyIndex = 0;
        const newOrder = [];
        for (let pos of positions) {
            const isEmpty = emptyPositions.some(e => e.x === pos.x && e.y === pos.y);
            if (isEmpty) {
                newOrder.push(emptyCards[emptyIndex++]);
            } else {
                newOrder.push(studentCards[studentIndex++]);
            }
        }
        // Append remaining empty cards (hidden)
        for (let i = emptyIndex; i < emptyCards.length; i++) {
            newOrder.push(emptyCards[i]);
        }
        // Reorder container
        container.innerHTML = '';
        newOrder.forEach(card => container.appendChild(card));
        // Show/hide empties
        emptyCards.forEach((card, i) => {
            card.style.display = i < numEmptiesNeeded ? 'flex' : 'none';
        });
        // Set unique random emojis for visible empties
        const visibleEmptyCards = emptyCards.filter(c => c.style.display === 'flex');
        if (visibleEmptyCards.length > 0) {
            const shuffledEmojis = [...emojis];
            for (let i = shuffledEmojis.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledEmojis[i], shuffledEmojis[j]] = [shuffledEmojis[j], shuffledEmojis[i]];
            }
            visibleEmptyCards.forEach((card, i) => {
                card.innerHTML = shuffledEmojis[i];
            });
        }
    }

    function shuffleAndColor() {
        const container = document.querySelector('.container');
        const allCards = Array.from(container.children);
        const studentCards = allCards.filter(c => !c.classList.contains('empty-card'));
        const numStudents = studentCards.length;
        const cols = Math.max(1, Math.floor((container.offsetWidth + 10) / 160));
        const remainder = numStudents % cols;
        const numEmptiesNeeded = remainder === 0 ? 0 : cols - remainder;
        const emptyCards = allCards.filter(c => c.classList.contains('empty-card'));
        const total = numStudents + numEmptiesNeeded;
        const {emptyPositions, available} = getEmptyPositions(cols, numEmptiesNeeded, total);
        // Shuffle student cards
        for (let i = studentCards.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [studentCards[i], studentCards[j]] = [studentCards[j], studentCards[i]];
        }
        // Shuffle available positions
        for (let i = available.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [available[i], available[j]] = [available[j], available[i]];
        }
        // Create positions array in order
        const positions = [];
        for (let y = 0; y < total / cols; y++) {
            for (let x = 0; x < cols; x++) {
                positions.push({x, y});
            }
        }
        // Assign cards to positions
        let studentIndex = 0;
        let emptyIndex = 0;
        const newOrder = [];
        for (let pos of positions) {
            const isEmpty = emptyPositions.some(e => e.x === pos.x && e.y === pos.y);
            if (isEmpty) {
                newOrder.push(emptyCards[emptyIndex++]);
            } else {
                newOrder.push(studentCards[studentIndex++]);
            }
        }
        // Append remaining empty cards (hidden)
        for (let i = emptyIndex; i < emptyCards.length; i++) {
            newOrder.push(emptyCards[i]);
        }
        // Reorder container
        container.innerHTML = '';
        newOrder.forEach(card => container.appendChild(card));
        // Show/hide empties
        emptyCards.forEach((card, i) => {
            card.style.display = i < numEmptiesNeeded ? 'flex' : 'none';
        });
        // Set unique random emojis for visible empties
        const visibleEmptyCards = emptyCards.filter(c => c.style.display === 'flex');
        if (visibleEmptyCards.length > 0) {
            const shuffledEmojis = [...emojis];
            for (let i = shuffledEmojis.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledEmojis[i], shuffledEmojis[j]] = [shuffledEmojis[j], shuffledEmojis[i]];
            }
            visibleEmptyCards.forEach((card, i) => {
                card.innerHTML = shuffledEmojis[i];
            });
        }
        // Assign colors to student cards
        const hues = [];
        for (let i = 0; i < numStudents; i++) {
            hues.push((i * 360) / numStudents);
        }
        // Shuffle hues
        for (let i = hues.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [hues[i], hues[j]] = [hues[j], hues[i]];
        }
        let hueIndex = 0;
        studentCards.forEach(card => {
            const lightness = 90 + (hueIndex * 2) / (numStudents - 1);
            card.style.backgroundColor = `hsl(${hues[hueIndex]}, 30%, ${lightness}%)`;
            hueIndex++;
        });
    }

    function animateShuffle() {
        const btn = document.getElementById('shuffle-btn');
        btn.disabled = true;
        btn.textContent = 'Shuffling...';
        let steps = 25;
        let delay = 1; // Start extremely fast
        let increment = 1;

        function doStep() {
            shuffleAndColor();
            steps--;
            if (steps <= 0) {
                btn.disabled = false;
                btn.textContent = '亂序排列';
            } else {
                // Gradually slow down
                // delay += 5; // Linear increase
                delay += increment;
                increment += 2;
                setTimeout(doStep, delay);
            }
        }
        doStep();
    }

    document.addEventListener('DOMContentLoaded', function() {
        updateEmpties();
        shuffleAndColor(); // Initial shuffle
        const btn = document.getElementById('shuffle-btn');
        btn.addEventListener('click', animateShuffle);
    });

    window.addEventListener('resize', updateEmpties);
    </script>
    </body>
    </html>
    